var S=Object.defineProperty;var h=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,z=Object.prototype.propertyIsEnumerable;var m=(a,o,n)=>o in a?S(a,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[o]=n,f=(a,o)=>{for(var n in o||(o={}))x.call(o,n)&&m(a,n,o[n]);if(h)for(var n of h(o))z.call(o,n)&&m(a,n,o[n]);return a};(function(a,o){typeof exports=="object"&&typeof module!="undefined"?module.exports=o(require("vue"),require("axios")):typeof define=="function"&&define.amd?define(["vue","axios"],o):(a=typeof globalThis!="undefined"?globalThis:a||self,a.useAuth=o(a.Vue,a.axios))})(this,function(a,o){"use strict";function n(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var d=n(o);const l=a.ref(!1),r=a.ref(!1),i=a.ref(null);function g(){let e={axiosInstance:d.default,tokenKey:"token",storageKey:"token",authorizationScheme:"Bearer"};function y(u){return e=f(f({},e),u),e}function I(u,s){return r.value=!0,i.value=null,e.axiosInstance.post(u,{method:"POST",data:s}).then(t=>(e.axiosInstance.defaults.headers.common.Authorization=e.authorizationScheme+" "+t.data[e.tokenKey],s.remember?localStorage.setItem(e.storageKey,t.data[e.tokenKey]):sessionStorage.setItem(e.storageKey,t.data[e.tokenKey]),l.value=!0,t)).catch(t=>(i.value=t.response,c(),t)).finally(()=>r.value=!1)}function v(u,s){return r.value=!0,i.value=null,e.axiosInstance.post(u,{method:"POST",data:s}).then(t=>t).catch(t=>(i.value=t.response,c(),t)).finally(()=>r.value=!1)}function K(u){r.value=!0,i.value=null;let s=!1;return localStorage.getItem(e.storageKey)?(s=!0,e.axiosInstance.defaults.headers.common.Authorization=e.authorizationScheme+" "+localStorage.getItem(e.storageKey)):e.axiosInstance.defaults.headers.common.Authorization=e.authorizationScheme+" "+sessionStorage.getItem(e.storageKey),e.axiosInstance.get(u).then(t=>(e.axiosInstance.defaults.headers.common.Authorization=e.authorizationScheme+t.data[e.tokenKey],s?localStorage.setItem(e.storageKey,t.data[e.tokenKey]):sessionStorage.setItem(e.storageKey,t.data[e.tokenKey]),l.value=!0,t)).catch(t=>(c(),t)).finally(()=>r.value=!1)}function c(){e.axiosInstance.defaults.headers.common.Authorization=!1,localStorage.removeItem(e.storageKey),sessionStorage.removeItem(e.storageKey),l.value=!1}return{login:I,register:v,refresh:K,logout:c,init:y,isAuth:l,isLoading:r,error:i}}return g});
